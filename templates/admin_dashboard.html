{% extends "base.html" %}
{% block content %}
<section class="hero small-hero">
  <h2>Admin Dashboard</h2>
</section>

<main class="content">
  <section class="card">
    <h3>All Registered Patients</h3>

    {% if patients and patients|length > 0 %}
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Patient ID</th>
              <th>Gender</th>
              <th>Age</th>
              <th>Hypertension</th>
              <th>Ever Married</th>
              <th>Work Type</th>
              <th>Residence</th>
              <th>Glucose</th>
              <th>BMI</th>
              <th>Smoking</th>
              <th>Stroke</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for patient in patients %}
              <tr>
                <td>{{ (page - 1) * per_page + loop.index }}</td>
                <td>{{ patient.patient_id }}</td>
                <td>{{ patient.gender }}</td>
                <td>{{ patient.age }}</td>
                <td>{{ patient.hypertension }}</td>
                <td>{{ patient.ever_married }}</td>
                <td>{{ patient.work_type }}</td>
                <td>{{ patient.residence_type }}</td>
                <td>{{ patient.avg_glucose_level }}</td>
                <td>{{ patient.bmi }}</td>
                <td>{{ patient.smoking_status }}</td>
                <td>{{ patient.stroke }}</td>
                <td>
                  <a href="{{ url_for('edit_patient', patient_id=patient.patient_id) }}" class="btn">Edit</a>
                  <form method="POST" action="{{ url_for('delete_patient', patient_id=patient.patient_id) }}" style="display:inline;">
                    <button type="submit" class="btn" onclick="return confirm('Are you sure you want to delete this patient?')">Delete</button>
                  </form>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- âœ… Pagination Controls -->
      <div class="pagination">
        {% set total_pages = (total // per_page) + (1 if total % per_page > 0 else 0) %}
        {% for p in range(1, total_pages + 1) %}
          {% if p == page %}
            <span class="page current">{{ p }}</span>
          {% else %}
            <a href="{{ url_for('admin_dashboard', page=p) }}" class="page">{{ p }}</a>
          {% endif %}
        {% endfor %}
      </div>

    {% else %}
      <p>No patients registered yet.</p>
    {% endif %}
  </section>
</main>
{% endblock %}
